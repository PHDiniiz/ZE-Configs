//Written By Color[STEAM_1:0:44837813]
//DO NOT COPY WITHOUT MY PERMISSION
//Patched version intended for use with GFL ze_atos_v1_11 stripper
//Fixes raw HTML formatting showing in hint text
//install as csgo/scripts/vscripts/ze_atos/functions_patched.nut
IncludeScript("ze_atos/init.nut");function PlayBGM(index){local message = "message " + bgm[index];EntFire("bgm","StopSound","");EntFire("bgm","AddOutput",message,0.01);EntFire("bgm","PlaySound","",0.02);}function SpawnButton(){local num = RandomInt(1,1000);local origin = null; switch(num % 8){case 0:origin = "-9253 8401 1320";break;case 1:origin = "-8997 8401 1320";break;case 2:origin = "-8741 8401 1320";break;case 3:origin = "-8485 8401 1320";break;case 4:origin = "-8229 8401 1320";break;case 5:origin = "-7973 8401 1320";break;case 6:origin = "-7717 8401 1320";break;case 7:origin = "-7461 8401 1320";break;}origin = "origin " + origin;EntFire("scene1_temp_1","AddOutput",origin);EntFire("scene1_temp_1","ForceSpawn","",0.1);}function DisplayText(time){EntFire("global_text","Display","",time+0.01);EntFire("global_text","Display","",time+1.01);EntFire("global_text","Display","",time+2.01);}function ShowTimeHUD(second){for(local i=0;i<=second;i++){message <- null;local j = second-i;if(j == 0){break;};if(j > 15){message = "message "+j.tostring()+"s left!";};else if(j > 5 && j <= 15){message = "message "+j.tostring()+"s left!";};else if(j > 0 && j <=5){message = "message "+j.tostring()+"s left!";};;;EntFire("global_hud","AddOutput",message,i);EntFire("global_hud","ShowMessage","",i+0.01);}}function EnableZMTeleport(index){local num = RandomInt(0,8);local teleportName = null;switch(index){case 1:teleportName = "scene1_teleport_1";break;case 2:teleportName = "scene1_teleport_2";break;case 3:teleportName = "scene1_teleport_4";break;case 4:teleportName = "scene1_teleport_5";break;case 5:teleportName = "scene1_teleport_6";break;case 6:teleportName = "scene1_teleport_8";break;case 7:teleportName = "scene1_teleport_9";break;case 8:teleportName = "scene1_teleport_10";break;case 9:teleportName = "scene1_teleport_12";break;case 10:teleportName = "scene2_teleport_1";break;case 11:teleportName = "scene2_teleport_2";break;case 12:teleportName = "scene2_teleport_3";break;case 13:teleportName = "scene3_teleport_1";break;case 14:teleportName = "scene3_teleport_2";break;case 15:teleportName = "scene3_teleport_3";break;case 16:teleportName = "scene3_teleport_4";break;case 17:teleportName = "scene3_teleport_5";break;case 18:teleportName = "scene3_teleport_6";break;case 19:teleportName = "scene3_teleport_8";break;case 20:teleportName = "scene3_teleport_10";break;case 21:teleportName = "scene3_teleport_11";break;case 22:teleportName = "scene3_teleport_12";break;case 23:teleportName = "scene2_teleport_4";break;case 24:teleportName = "scene4_teleport_1";break;case 25:teleportName = "scene4_teleport_2";break;case 26:teleportName = "scene4_teleport_3";break;case 27:teleportName = "scene4_teleport_4";EntFire("scene4_break_extra_1","Break","",num+5);EntFire("scene4_wall_extra_1","Kill","",num+5);break;case 28:teleportName = "scene4_teleport_5";break;case 29:teleportName = "scene4_teleport_6";break;case 30:teleportName = "scene4_teleport_8";break;case 31:teleportName = "scene4_teleport_9";break;case 32:teleportName = "scene4_teleport_10";break;case 33:teleportName = "scene4_teleport_11";break;case 34:teleportName = "scene4_teleport_12";break;}if(index == 1){EntFire("start_teleport_all","Enable","",num);};EntFire(teleportName,"Enable","",num);}function KillStageEntities(currentStage){if(currentStage == 4 || currentStage == 5){EntFire("sky_real","Trigger","");}else{EntFire("sky_cartoon","Trigger","");};local stages = [];for(local i=1;i<=TOTALSTAGES;i++){local temp = "kill_stage" + i.tostring();stages.append(temp);}for(local i=0;i<stages.len();i++){local j = i+1;if(j != currentStage){EntFire(stages[i],"Trigger","");}}}function SetStageBrush(currentStage){local brushes = [];for(local i=1;i<=TOTALSTAGES;i++){local temp = "stage" + i.tostring() + "_brush";brushes.append(temp);}for(local i=0;i<brushes.len();i++){local j = i+1;if(j != (currentStage%5)+1){EntFire(brushes[i],"Enable","");}else{EntFire(brushes[i],"Disable","");}}if(currentStage == 4){EntFire("cmd","Command","sm_g_cv_Money 1000");EntFire("cmd","Command","sm_he_limit 1");EntFire("cmd","Command","sm_smoke_limit 1");EntFire("cmd","Command","sm_molotov_limit 0");EntFire("cmd","Command","sm_taggrenade_limit 0");EntFire("cmd","Command","sm_zeusweapons_decoy 0");EntFire("cmd","Command","zr_class_modify zombies health 10000");}else SetCvar();}function SetButtons(second){local cmd = "<--Hold for " + second.tostring() + "s-->";local fiveLeft = second - 5; EntFire("global_text","SetText",cmd);cmd = "say " + cmd;EntFire("cmd","Command",cmd);ShowTimeHUD(second);DisplayText(0);EntFire("cmd","Command","say <--5s left-->",fiveLeft);}function SetScene2Break(){for(local i=1;i<=3;i=i+2){local temp = "scene2_break_";local num = RandomInt(0,1000);switch(num % 2){case 0:temp = temp + i.tostring();break;case 1:temp = temp + ((i+1).tostring());break;}EntFire(temp,"Break","");}}function SpawnScene1Wall(){local origin = "origin ";local num = RandomInt(0,1000);switch(num % 3){case 0:origin += "-8770 5760 1688";break;case 1:origin += "-7362 8622 1656";break;case 2:origin += "-7362 8820 1656";break;}EntFire("item_wall_weapon_template","AddOutput",origin);EntFire("item_wall_weapon_template","ForceSpawn","",0.01);}function SpawnScene3Laser(){	g_juggLaser += 1;	if(g_juggLaser == 1){if(RandomInt(0,1)){for(local i=1;i<5;i++){SetScene3LaserPath2(i);}};EntFire("scene3_laser1_train","StartForward","",0.01);EntFire("scene3_laser1_sound","PlaySound","",0.01);;return;;};if(g_juggLaser==2){SetScene3LaserPath2(RandomInt(1,4));EntFire("scene3_laser1_train","StartForward","",0.01);EntFire("scene3_laser1_sound","PlaySound","",0.01);return;};for(local i=1;i<6;i++){if(i == 5){EntFire("scene3_laser1_train","StartForward","",0.01);EntFire("scene3_laser1_sound","PlaySound","",0.01);}else SetScene3LaserPath(i);}}function SetScene3LaserPath(i){local name = "scene3_laser1_path_" + i.tostring();local path = Entities.FindByName(null,name);if(path != null){local origin = path.GetOrigin();local num = RandomInt(0,100);if(num % 2 != 0){origin = Vector(origin.x,origin.y,origin.z+48);path.SetOrigin(origin);}}}function SetScene3LaserPath2(i){local name = "scene3_laser1_path_" + i.tostring();local path = Entities.FindByName(null,name);if(path != null){local origin = path.GetOrigin();origin = Vector(origin.x,origin.y,origin.z+48);path.SetOrigin(origin);}}function SpawnScene3Boss(){SpawnBossCounters();EntFire("globalshake_255","StartShake","");SetTimer("scene3_boss_skill_timer",1,10);SetTimer("scene3_boss_hurt_timer",1,180);EntFire("scene3_boss_skill_timer","AddOutput","OnTimer functions:RunScriptCode:ChooseScene3BossSkills():0:0",1);EntFire("scene3_boss_hurt_timer","AddOutput","OnTimer scene3_boss_hurt:Enable::0:1",1);EntFire("boss_counter_1_*","Enable","",1);EntFire("boss_counter_1_*","Disable","",5);for(local i=1;i<7;i++){local name = null;if(i == 6){name = "boss_counter_2";}else{name = "boss_counter_1_" + i.tostring();};SetScene3BossCounters(name);}SpawnCameras(14,280,0,4,280,0,Vector(-12002,-10300,8384),Vector(-11927,-10886,8384),11);local mdl = Entities.CreateByClassname("prop_dynamic");mdl.SetModel("models/color/lizard/lizard.mdl");mdl.__KeyValueFromString("targetname", "scene3_boss_model");mdl.__KeyValueFromString("DefaultAnim", "idle");mdl.SetAngles(0,90,0);mdl.SetOrigin(Vector(-11852,-11318.4,8233));EntFireByHandle(mdl,"SetAnimation","walk",0,mdl,mdl);EntFireByHandle(mdl,"SetParent","scene3_boss_train",0,mdl,mdl);EntFire("scene3_boss_train","StartForward","");EntFire("scene3_boss_sound","PlaySound","");EntFire("functions","RunScriptCode","ShowBossTime(180)",11);EntFire("scene3_boss_hp_bar","ShowSprite","",11);EntFire("boss_counter_1_1","Enable","",11);EntFire("boss_counter_2","Enable","",11);EntFire("scene3_boss_skill_timer","Enable","",11);EntFire("scene3_boss_hurt_timer","Enable","",11);}function SetScene3BossCounters(name){if(name == "boss_counter_2"){EntFire(name,"AddOutput","OnHitMax scene3_boss_train:StartForward::0.01:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_model:SetAnimation:run:0.01:1");EntFire(name,"AddOutput","OnGetValue scene3_boss_hp_toggle:SetTextureIndex::0:0");EntFire(name,"AddOutput","OnHitMax scene3_boss_hp_bar:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_hp_toggle:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_hurt_4:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_trigger_12:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_hurt:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_spike*:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_push*:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_hurt_timer:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_skill_timer:Kill::0:1");EntFire(name,"AddOutput","OnHitMax bosstime_text:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_sound:PlaySound::0:1");EntFire(name,"AddOutput","OnHitMax scene3_boss_push_sound:Volume:0:0:1");EntFire(name,"AddOutput","OnHitMax scene3_break_7:Break::13:1");EntFire(name,"AddOutput","OnHitMax bgm_timer_4:Enable::0:1");EntFire(name,"AddOutput","OnHitMax bgm_timer_4:FireTimer::0.01:1");EntFire(name,"AddOutput","OnHitMax globalshake_255:StartShake::0:1");EntFire(name,"AddOutput","OnHitMax scene3_wall_13:Kill::0:1");EntFire(name,"AddOutput","OnHitMax scene3_push_*:Kill::0:1");}else{EntFire(name,"AddOutput","OnHitMin scene3_boss_box:SetHealth:10000000:0:1");EntFire(name,"AddOutput","OnHitMin scene3_boss_he_box:SetHealth:10000000:0:1");EntFire(name,"AddOutput","OnHitMin boss_counter_2:Add:1:0:1");}}function SetBossHP(min,max){local hp = RandomInt(min,max);EntFire("boss_counter_1_*","Add",hp);}function SpawnCameras(x,y,z,x1,y1,z1,v1,v2,time){local viewcontrol = Entities.CreateByClassname("point_viewcontrol_multiplayer");local viewtarget = Entities.CreateByClassname("info_target");viewcontrol.__KeyValueFromString("targetname", "viewcontrol");viewtarget.__KeyValueFromString("targetname", "viewtarget");viewtarget.SetAngles(x,y,z);viewtarget.SetOrigin(v1);viewcontrol.SetAngles(x1,y1,z1);viewcontrol.SetOrigin(v2);viewcontrol.__KeyValueFromString("target_entity", "viewtarget");viewcontrol.__KeyValueFromFloat("interp_time", time);EntFireByHandle(viewcontrol,"Enable","",0,viewcontrol,viewcontrol);EntFireByHandle(viewcontrol,"StartMovement","",0.01,viewcontrol,viewcontrol);EntFireByHandle(viewcontrol,"Disable","",time-0.01,viewcontrol,viewcontrol);EntFireByHandle(viewcontrol,"Kill","",time,viewcontrol,viewcontrol);EntFireByHandle(viewtarget,"Kill","",time,viewtarget,viewtarget);}function SpawnBossCounters(){for(local i=1;i<7;i++){local name = null;local counter = Entities.CreateByClassname("math_counter");if(i == 6){name = "boss_counter_2";counter.__KeyValueFromInt("max",5);EntFireByHandle(counter,"AddOutput","OnHitMax !self:Kill::0:1",0,counter,counter);}else{if(i != 5){name = "boss_counter_1_" + (i+1).tostring();name = "OnHitMin " + name + ":Enable::0:1";EntFireByHandle(counter,"AddOutput","OnHitMin boss_counter_2:GetValue::0.01:1",0,counter,counter);EntFireByHandle(counter,"AddOutput",name,0,counter,counter);};name = "boss_counter_1_" + i.tostring();counter.__KeyValueFromInt("max",1000000);counter.__KeyValueFromInt("startvalue",64);EntFireByHandle(counter,"AddOutput","OnHitMin !self:Kill::0:1",0,counter,counter);};counter.__KeyValueFromString("targetname",name);counter.__KeyValueFromInt("StartDisabled",1);}}function ChooseScene3BossSkills(){local num = RandomInt(1,1000);switch (num%3){case 0:EntFire("scene3_boss_skill_timer","Disable","");EntFire("scene3_boss_skill_timer","Enable","",4.5);EntFire("scene3_boss_model","SetAnimation","attack1");EntFire("scene3_boss_push_template","ForceSpawn","");break;case 1:EntFire("scene3_boss_model","SetAnimation","attack2");SpawnSpikes2();break;case 2:EntFire("scene3_boss_model","SetAnimation","attack2");SpawnSpikes();break;}}function SpawnSpikes(){EntFire("scene3_spike_sound","PlaySound","");local spikes = ["origin -12007 -9828 8592","origin -11836 -9828 8592","origin -11665 -9828 8592","origin -11665 -10084 8592","origin -11836 -10084 8592","origin -12007 -10084 8592"];local index = ChooseNumbers(6,5);local template = Entities.FindByName(null,"scene3_spike_template");for(local i = 0;i<5;i++){EntFireByHandle(template,"AddOutput",spikes[index[i]],i*0.02,template,template);EntFireByHandle(template,"ForceSpawn","",i*0.02+0.01,template,template);}EntFire("scene3_spike_move*","Open","",3);EntFire("scene3_spike_move*","KillHierarchy","",4.5);EntFire("scene3_spike_aim*","Kill","",4.5);}function SpawnSpikes2(){EntFire("scene3_spike_sound","PlaySound","");local template = Entities.FindByName(null,"scene3_spike2_template");for(local i = 0;i<5;i++){local x = RandomInt(-12020,-11652);local y = RandomInt(-10140,-9772);local origin = "origin " + x.tostring()+" " + y.tostring()+" 7976";EntFireByHandle(template,"AddOutput",origin,i*0.02,template,template);EntFireByHandle(template,"ForceSpawn","",i*0.02+0.01,template,template);}EntFire("functions","RunScriptCode","RandomBaseVelocity()",1);EntFire("scene3_spike2_move*","Open","",3);}function RandomBaseVelocity(){local num = RandomInt(1,1000);local output = null;switch(num % 4){case 0:output = "OnStartTouch !activator:AddOutput:basevelocity -500 0 500:0:0";break;case 1:output = "OnStartTouch !activator:AddOutput:basevelocity 500 0 500";break;case 2:output = "OnStartTouch !activator:AddOutput:basevelocity 0 500 500";break;case 3:output = "OnStartTouch !activator:AddOutput:basevelocity 0 -500 500";break;}EntFire("scene3_spike2_trigger*","AddOutput",output);}function RandomPushDir(){local num = RandomInt(1,1000);switch(num % 4){case 0:EntFire("scene3_boss_push_trigger","SetPushDirection","0 90 0");break;case 1:EntFire("scene3_boss_push_trigger","SetPushDirection","0 0 0");break;case 2:EntFire("scene3_boss_push_trigger","SetPushDirection","0 180 0");break;case 3:EntFire("scene3_boss_push_trigger","SetPushDirection","0 270 0");break;}}function ChooseNumbers(totalNumber,chooseNumber){local index = [];local count = 0;while(count < chooseNumber){local num = RandomInt(1,1000);num = num % totalNumber;local flag = 1;for(local j=0;j<index.len();j++){if(num == index[j]){flag = 0;break;};}if(flag){index.append(num);count += 1;};}return index;}function SetTimer(targetname,StartDisabled,RefireTime){local timer = Entities.CreateByClassname("logic_timer");timer.__KeyValueFromString("targetname",targetname);timer.__KeyValueFromInt("StartDisabled",StartDisabled);timer.__KeyValueFromFloat("RefireTime",RefireTime);}function ShowBossTime(second){for(local i=0;i<=second;i++){message <- null;local j = second-i;if(j == 0){break;};message = "Boss Time: "+j.tostring();EntFire("bosstime_text","SetText",message,i);EntFire("bosstime_text","Display","",i+0.01);}}function StartScene3Laser(){EntFire("scene3_laser1_template","ForceSpawn","");local num = RandomInt(1,1000);switch(num % 3){case 0:EntFire("scene3_laser_master","SetAnimation","attack1");break;case 1:EntFire("scene3_laser_master","SetAnimation","attack3");break;case 2:EntFire("scene3_laser_master","SetAnimation","attack4");break;}}function SpawnScene2Grenade(){local origin = ["origin 3756 -232 568","origin 3840 -232 568","origin 3920 -232 568"];for (local i = 0; i < origin.len(); i++) {local num = RandomInt(1,1000);local temp = null;switch(num % 2){case 0:temp = "he_temp";break;case 1:temp = "molotov_temp";break;}if(temp != null){EntFire(temp,"AddOutput",origin[i],i);EntFire(temp,"ForceSpawn","",i+0.01);}}}function SpawnGhost(){if(activator != null){local temp = Entities.FindByName(null,"ghost_template");local origin = activator.GetOrigin();origin = Vector(origin.x,origin.y,origin.z+32);temp.SetOrigin(origin);EntFireByHandle(temp,"ForceSpawn","",0.01,temp,temp);}}function ShowItemText(index){local global_text=SetGameText("","255 255 0",0.4,0.2,0.1,0.1,10,0,0,3);if(global_text != null){global_text.__KeyValueFromString("message", itemText[index-1]);EntFireByHandle(global_text,"Display","",0.01,activator,global_text);EntFireByHandle(global_text,"Kill","",11,global_text,global_text);}}function SpawnArcLightning(flag){if(!flag){item_arc_lightning_pos1 = activator.GetOrigin();item_arc_lightning_pos1 = ModifyOriginZ(item_arc_lightning_pos1,48);for (local i = 0; i < ITEM_ARC_LIGHTNING_MAXCOUNT; i++) {EntFire("functions","RunScriptCode","SpawnArcLightning(1)",i.tofloat()/4);if(i == ITEM_ARC_LIGHTNING_MAXCOUNT-1){EntFire("functions","RunScriptCode","item_arc_lightning_pos1 <- null;",ITEM_ARC_LIGHTNING_MAXCOUNT.tofloat()/4);EntFire("functions","RunScriptCode","item_arc_lightning_pos2 <- null;",ITEM_ARC_LIGHTNING_MAXCOUNT.tofloat()/4);EntFire("functions","RunScriptCode","item_arc_lightning_target.clear();",ITEM_ARC_LIGHTNING_MAXCOUNT.tofloat()/4);}}}else{local lightning1 = Entities.FindByName(null,"item_arc_lightning_1");local lightning2 = Entities.FindByName(null,"item_arc_lightning_2");local target = null;while((target = Entities.FindByClassnameWithin(target,"player",item_arc_lightning_pos1,512)) != null){local isFind = 0;for (local i = 0; i < item_arc_lightning_target.len(); i++) {if(target == item_arc_lightning_target[i]){isFind = 1;break;}}if(!isFind){if(target.GetTeam() == 2){item_arc_lightning_target.append(target);item_arc_lightning_pos2 = target.GetOrigin();item_arc_lightning_pos2 = ModifyOriginZ(item_arc_lightning_pos2,48);if(lightning1 && lightning2){local name = target.GetName();if(name == "cure_user" || name == "alacrity_user" || name == "blackhole_user" || name == "rock_monster_user" || name == "rasengan_user" || name == "particle_gun_user") target.SetHealth(ceil(target.GetHealth()/2));else target.SetHealth(1000);lightning1.SetOrigin(item_arc_lightning_pos1);lightning2.SetOrigin(item_arc_lightning_pos2);item_arc_lightning_pos1 = item_arc_lightning_pos2;EntFire("item_arc_lightning_beam","TurnOn","");EntFire("item_arc_lightning_beam","TurnOff","",0.24);for (local i = 0; i < 10; i++){EntFire("speed","ModifySpeed","0",i*0.1,target);}EntFire("speed","ModifySpeed","1",1,target);EntFire("item_arc_lightning_sound","SetLocalOrigin",ConvertOrigin(item_arc_lightning_pos1));ChooseArcLightningSound(item_arc_lightning_target.len());};break;}}}}}function ChooseArcLightningSound(index){local sound = Entities.FindByName(null,"item_arc_lightning_sound");if(sound != null){EntFireByHandle(sound,"StopSound","",0,sound,sound);sound.__KeyValueFromString("message",item_arc_lightning_sound[index-1]);EntFireByHandle(sound,"PlaySound","",0.01,sound,sound);}}function SpawnThunderFire() {EntFire("item_thunder_fire_particle","Start","");EntFire("item_thunder_fire_particle","Stop","",0.8);local anglesY = activator.GetAngles().y;local c = null;local s = null;if(anglesY == 0 || anglesY == 180){s = 1;};if(anglesY == 90 || anglesY == 270){c = 1;}else{anglesY = anglesY*PI/180;c = cos(anglesY);s = sin(anglesY);};local origin = activator.GetOrigin();for (local i = 0; i < 4; i++) {local dist = 400;if(i == 0){dist = 0;};local point = Vector(dist*c+origin.x,dist*s+origin.y,origin.z);local temp = ConvertOrigin(point);temp = "origin " + temp;EntFire("item_thunder_fire_move_template","AddOutput",temp,i*0.2);EntFire("item_thunder_fire_move_template","ForceSpawn","",i*0.2+0.01);origin = point;}}function ConvertOrigin(item){local newOrigin = (item.x).tostring()+" "+(item.y).tostring()+" "+(item.z).tostring();return newOrigin;}function ModifyOriginZ(item,distance){item = Vector(item.x,item.y,item.z+distance);return item;}function SpawnFirestorm(flag){if(flag){local origin = activator.GetOrigin();local hurt = Entities.FindByName(null,"item_firestorm_hurt");local sound = Entities.FindByName(null,"item_firestorm_sound");sound.SetOrigin(origin);hurt.SetOrigin(origin);EntFireByHandle(sound,"PlaySound","",0,null,null);item_firestorm_origins = [Vector(origin.x-200,origin.y,origin.z),Vector(origin.x+200,origin.y,origin.z),Vector(origin.x,origin.y-200,origin.z),Vector(origin.x,origin.y+200,origin.z)Vector(origin.x+160,origin.y+100,origin.z),Vector(origin.x-50,origin.y-60,origin.z),Vector(origin.x+130,origin.y-100,origin.z),Vector(origin.x-100,origin.y+140,origin.z),origin];for (local i = 0; i < ITEM_FIRESTORM_MAXCOUNT;i++) {EntFire("functions","RunScriptCode","SpawnFirestorm(0)",i*1.8+0.01);EntFireByHandle(hurt,"Enable","",i*1.8+1.5,null,null);EntFireByHandle(hurt,"Disable","",i*1.8+1.8,null,null);}return;};for (local i = 0; i < item_firestorm_origins.len(); i++) {local origin = "origin " + ConvertOrigin(item_firestorm_origins[i]);EntFire("item_firestorm_model_template","AddOutput",origin,i*0.02);EntFire("item_firestorm_model_template","ForceSpawn",origin,i*0.02+0.01);}EntFire("item_firestorm_move","Open","",0.5);EntFire("item_firestorm_particle","Start","",0.5);}function SpawnParticle(index){local name = null;switch (index) {case 1:name = "item_poison_nova_particle_template";break;case 2:name = "item_gift_model_template";break;case 3:name = "item_water_particle_template";break;case 4:name = "item_wind_rasengan_particle_template";break;case 5:name = "item_lightning_particle_template";break;case 6:name = "item_scorched_earth_particle_template";break;case 7:name = "item_magic_particle_template";break;}local template = Entities.FindByName(null,name);template.SetOrigin(activator.GetOrigin());EntFireByHandle(template,"ForceSpawn","",0.01,null,null);}function FilterZombieName(){EntFire("stripper","StripWeaponsAndSuit","",0,activator);}function FreezePlayer(){for (local i = 0; i < 11; i++){EntFire("speed","modifyspeed","0",i*0.1,activator);}EntFire("speed","modifyspeed","1",6,activator);}function GetItemPre(index){index -= 1;local team = activator.GetTeam();local dest = null;local light = null;if(team == 2){dest = "item_zombie_destination_" + (index+1).tostring();light = item_zombie_light[index];}else if(team == 3){EntFire("stripper","StripWeaponsAndSuit","",0,activator);EntFire("item_supply","Use","",0.1,activator);light = item_human_light[index];dest = "item_human_destination_" + (index+1).tostring();};;EntFire(light,"Kill","");EntFire(dest,"Kill","",5);EntFire("!activator","RunScriptCode","self.SetVelocity(Vector(0,0,0));",0,activator);EntFire("speed","ModifySpeed","0",0,activator);EntFire("speed","ModifySpeed","0",0.1,activator);EntFire("speed","ModifySpeed","1",1,activator);}function GetItem(){local team = activator.GetTeam();local origin = null;local angles = null;if(team == 2){origin = "origin 11008 11648 80";angles = "self.SetAngles(0 330 0);";}else if(team == 3){origin = "origin 13312 11648 80";angles = "self.SetAngles(0 225 0);";};;EntFireByHandle(activator,"AddOutput",origin,1,null,null);EntFireByHandle(activator,"RunScriptCode",angles,1,null,null);}function SpawnZombieItem(){for (local i = 0; i < 8; i++) {local template = null;while(template == null){ local num = RandomInt(0,item_zombie_template.len()-1); template = item_zombie_template[num]; if(template == "item_cure_template") {if(item_cure_count-1 > -1){item_cure_count -= 1;}else{item_zombie_template.remove(num);template = null;} }else if(template == "item_alacrity_template") {if(item_alacrity_count-1 > -1){item_alacrity_count -= 1;}else{item_zombie_template.remove(num);template = null;} }else if(template == "item_blackhole_template") {if(item_blackhole_count-1 > -1){item_blackhole_count -= 1;}else{item_zombie_template.remove(num);template = null;} }else if(template == "item_rasengan_template") {if(item_rasengan_count-1 > -1){item_rasengan_count -= 1;}else{item_zombie_template.remove(num);template = null;} }else if(template == "item_rock_monster_template") {if(item_rock_monster_count-1 > -1){item_rock_monster_count -= 1;}else{item_zombie_template.remove(num);template = null;}}else if(template == "item_particle_gun_template"){if(item_particle_gun_count-1 > -1){item_particle_gun_count -= 1;}else{item_zombie_template.remove(num);template = null;}}}EntFire(template,"AddOutput","origin "+item_zombie_origin[i],i);EntFire(template,"ForceSpawn","",i+0.01);}}function SpawnHumanItem(flag,health=1){if(health==1){EntFire("item_health_human_template","AddOutput","origin -8021 7409 1324");EntFire("item_health_human_template","ForceSpawn","",0.01);};else if(health == 2){local n = RandomInt(0,1);local o = "origin -8480 -4688 328";if(n) o = "origin -6128 -2000 1104";EntFire("item_health_human_template","AddOutput",o);EntFire("item_health_human_template","ForceSpawn","",0.01);;}else if(health == 5){for (local i = 0; i < 8; i++){EntFire("item_bkb_template","AddOutput","origin "+item_human_origin[i],i);EntFire("item_bkb_template","ForceSpawn","",i+0.01);}return;};;;;if(flag){local n = RandomInt(0,100);n=n%2;if(n) item_human_template.push("wk_template");else item_human_template.push("item_jugg_template");};local index = ChooseNumbers(item_human_template.len(),8);for (local i = 0; i < 8; i++){ local template = item_human_template[index[i]];EntFire(template,"AddOutput","origin "+item_human_origin[i],i);EntFire(template,"ForceSpawn","",i+0.01);}}function ChooseNumbers(totalNumber,chooseNumber){local index = [];local count = 0;while(count < chooseNumber){local num = RandomInt(1,1000);num = num % totalNumber;local flag = 1;for(local j=0;j<index.len();j++){if(num == index[j]){flag = 0;break;}}if(flag){index.append(num);count += 1;}}return index;}function SpawnScene3Item(){local o = ["-8784 -3220 7896", "-10684 -2636 7952", "-11420 -4872 7888", "-12144 -5100 7880"];local num = RandomInt(0,3);EntFire("item_health_human_template","AddOutput","origin "+o[num%4]);EntFire("item_health_human_template","ForceSpawn","",0.01);}function PushRasenShuriken(){item_human_template.push("item_wind_rasengan_template");}function SetBlackKingBar(){EntFire("item_black_king_bar_button","Lock","");EntFire("item_black_king_bar_sound","PlaySound","");EntFire("item_black_king_bar_icon","ToggleSprite","");EntFire("item_black_king_bar_button","Unlock","",40);EntFire("item_black_king_bar_icon","ToggleSprite","",40);if(ITEM_BLACK_KING_BAR_MAXCOUNT){ITEM_BLACK_KING_BAR_MAXCOUNT -= 1;};if(activator.ValidateScriptScope()){local e = activator.GetScriptScope();if("wk" in e){if(e.wk == 1){return;};};;EntFire("!activator","SetDamageFilter","nofallandzombie",0,activator);EntFire("!activator","SetDamageFilter","nofall",ITEM_BLACK_KING_BAR_MAXCOUNT+3,activator);};}function ResetWK(){local handle = null;while(null != (handle = Entities.FindInSphere(handle,self.GetOrigin(),500000))){if(handle.GetClassname() == "player"){if(handle.ValidateScriptScope()){local e = handle.GetScriptScope();if("wk" in e){e.wk = 0;};EntFire("!activator","RunScriptCode","btn<-[];",0,handle);}}}}function Ban(){if(activator.ValidateScriptScope()){local e = activator.GetScriptScope();if("ban" in e){if(e.ban == 1){EntFire("!activator","AddOutput","origin 15872 14944 112",1,activator);}}}}function SetWKHealth(){if(activator.ValidateScriptScope()){local e = activator.GetScriptScope();if("wk" in e){if(e.wk == 1){EntFire("!activator","AddOutput","health 200",0,activator);EntFire("scene3_wk_trigger","Kill","");}}}}function SetDay(){for (local i = 0; i < 2; i++){for (local j = i*90; j <= (i+1)*90; j++){local temp = j - i*90;local minN = null;local maxN = null;if(i % 2 == 0){minN = 0.46 - 0.005*temp;maxN = 1 - 0.011*temp;}else{minN = 0.01 + 0.005*temp;maxN = 0.01+0.011*temp;};EntFire("tonemap","SetAutoExposureMin",minN.tostring(),j);EntFire("tonemap","SetAutoExposureMax",maxN.tostring(),j);}}}function ButtonCount(){if(activator.ValidateScriptScope()){local e = activator.GetScriptScope();local b = caller.GetName();if("btn" in e){for (local i = 0; i < e.btn.len(); i++){if(e.btn[i] == b) return;}e.btn.push(b);if(e.btn.len() == 3){e.btn.clear();EntFire("!activator","AddOutput","origin -2296 -11202 8450",0,activator);EntFire("!activator","RunScriptCode","self.SetVelocity(Vector(0,0,0));",0,activator);}}}}function CBreakCounter(m,flag=1,n="n"){if(flag){for (local i = 100; i < 112; i++){if(i == 104 || i == 103) CBreakCounter(16,0,"trip5_counter_"+i);else if(i == 106) CBreakCounter(6,0,"trip5_counter_106");else CBreakCounter(11,0,"trip5_counter_"+i);}return;};local mc = Entities.CreateByClassname("math_counter");mc.__KeyValueFromInt("max",m);mc.__KeyValueFromString("targetname",n);local t = n.slice(n.len()-3,n.len());EntFire(n,"AddOutput","OnHitMax !self:Kill::0:1");EntFire(n,"AddOutput","OnHitMax trip5_break_"+t+":Break::0:1");EntFire(n,"AddOutput","OnHitMax trip5_trigger_"+t+":Kill::0:1");}function CountPlayer(){local n = caller.GetName();n = n.slice(n.len()-3,n.len());EntFire("trip5_counter_"+n,"Add","1");EntFire("trip5_counter_"+n,"SetValue","0",2);}function ChooseTrip5BGM(){local n = RandomInt(2,4);EntFire("bgm_timer_"+n,"Enable","");EntFire("bgm_timer_"+n,"FireTimer","",0.01);}function SetCvar() {EntFire("cmd","Command","sm_g_cv_Money 10000");EntFire("cmd","Command","sm_he_limit 4");EntFire("cmd","Command","sm_smoke_limit 3");EntFire("cmd","Command","sm_molotov_limit 2");EntFire("cmd","Command","sm_taggrenade_limit 1");EntFire("cmd","Command","sm_zeusweapons_decoy 1");EntFire("cmd","Command","zr_class_modify zombies health 15000");}function PhysicsDetect(){local n = activator.GetName();if(n.find("item_particle_gun_proj")==0 || n.find("item_rasengan_box")==0) EntFire("!activator","Break","",0,activator);}function StartRain(){local max,min,p,p2,p3,p4 = null;for (local i = 1; i < 21; i++) {max = 1.75-i*0.0775;min = 1.25-i*0.0525;p = 400-i*40;p2 = i*12.75;p3 = 0.8+i*0.01;p4 = 9900-i*370;EntFire("tonemap","SetAutoExposureMax",max.tostring(),i);EntFire("tonemap","SetAutoExposureMin",min.tostring(),i);EntFire("fog_controller","SetStartDist",p.tostring(),i);EntFire("fog_controller","SetMaxDensity",p3.tostring(),i);EntFire("fog_controller","SetEndDist",p4.tostring(),i);EntFire("scene4_cloudy_model","AddOutput","renderamt "+p2.tostring(),i);if(i>10){p3 = (i-10)*10;EntFire("scene4_rain_area","AddOutput","renderamt "+p3.tostring(),i);}}EntFire("env_sound_global","PlaySound","",11);EntFire("bgm","Volume","5",11);EntFire("shadow","SetShadowsDisabled","1",15);EntFire("sun","TurnOff","",15);}function EndRain(){local max,min,p,p2,p3,p4 = null;for (local i = 1; i < 21; i++) {max = 0.2+i*0.0775;min = 0.2+i*0.0525;p = i*40-400;p2 = 255-i*12.75;p3 = 1-i*0.01;p4 = 2500+i*370;EntFire("tonemap","SetAutoExposureMax",max.tostring(),i);EntFire("tonemap","SetAutoExposureMin",min.tostring(),i);EntFire("fog_controller","SetStartDist",p.tostring(),i);EntFire("fog_controller","SetEndDist",p4.tostring(),i);EntFire("fog_controller","SetMaxDensity",p3.tostring(),i);EntFire("scene4_cloudy_model","AddOutput","renderamt "+p2.tostring(),i);if(i<11){p3 = 100-i*10;EntFire("scene4_rain_area","AddOutput","renderamt "+p3.tostring(),i);}}EntFire("env_sound_global","StopSound","",11);EntFire("bgm","Volume","10",11);EntFire("scene4_rain_area","Kill","",11);EntFire("shadow","SetShadowsDisabled","0",20);EntFire("sun","TurnOn","",15);}function SeaWitch(){local mdl = Entities.CreateByClassname("prop_dynamic");mdl.SetModel("models/color/sea_witch/sea_witch.mdl");mdl.__KeyValueFromString("targetname", "scene4_sea_witch");mdl.__KeyValueFromString("DefaultAnim", "idle");mdl.SetAngles(0,270,0);mdl.SetOrigin(Vector(9789,-11417,9127));EntFireByHandle(mdl,"SetAnimation","start",0,mdl,mdl);EntFireByHandle(mdl,"SetParent","scene4_sea_witch_parent",0,mdl,mdl);EntFire("bgm_timer_3","Enable","");EntFire("bgm_timer_3","FireTimer","",0.01);EntFire("bgm","Volume","7",0.1);EntFire("scene4_break_17","Kill","",0.1);EntFire("scene4_break_21","Break","",0.1);EntFire("scene4_jumpad_3","Kill","",0.1);EntFire("scene4_sea_witch_hp_add","Enable","");EntFire("scene4_sea_witch_hp_add","Kill","",0.5);EntFire("functions","RunScriptCode","boss_hp_section=boss_hp_total/36;",3);EntFire("scene4_sea_witch_start_particle","Start","");EntFire("scene4_sea_witch_splash","Start","",3);EntFire("scene4_sea_witch_start_particle","Stop","",6);EntFire("scene4_sea_witch_box","Enable","",6);EntFire("scene4_sea_witch_skill_timer","Enable","",6);SpawnCameras2("vc1","vt1",0,90,0,0,90,0,Vector(9802,-11711,9597.125),Vector(9802,-12315.099609,9219.216003),1,1,0);SpawnCameras2("vc2","vt2",0,90,0,0,90,0,Vector(9802,-12003.700195,9259.593994),Vector(9802,-11711,9597),5,1,1);SetGameText("boss_hp_bar","255 69 0",0.2,0.3,0,0,1,0,1,2);EntFire("boss_hp_bar_timer","Enable","",5);}function SpawnCameras2(n1,n2,x,y,z,x1,y1,z1,v1,v2,time,flag,starttime){local viewcontrol = Entities.CreateByClassname("point_viewcontrol_multiplayer");local viewtarget = Entities.CreateByClassname("info_target");viewcontrol.__KeyValueFromString("targetname", n1);viewtarget.__KeyValueFromString("targetname", n2);viewtarget.SetAngles(x,y,z);viewtarget.SetOrigin(v1);viewcontrol.SetAngles(x1,y1,z1);viewcontrol.SetOrigin(v2);viewcontrol.__KeyValueFromString("target_entity", n2);viewcontrol.__KeyValueFromFloat("interp_time", time);viewcontrol.__KeyValueFromInt("spawnflags", flag);EntFireByHandle(viewcontrol,"Enable","",starttime,viewcontrol,viewcontrol);EntFireByHandle(viewcontrol,"StartMovement","",starttime+0.01,viewcontrol,viewcontrol);EntFireByHandle(viewcontrol,"Disable","",starttime+time-0.01,viewcontrol,viewcontrol);EntFireByHandle(viewcontrol,"Kill","",starttime+time+0.01,viewcontrol,viewcontrol);EntFireByHandle(viewtarget,"Kill","",starttime+time+0.01,viewtarget,viewtarget);}function ShowBossHP(){local h = ceil((boss_hp_total.tofloat()/boss_hp_section));if(h <= 0) {sea_witch_die = 1;EntFire("scene4_sea_witch*","Kill","");EntFire("boss_hp_bar_timer","Kill","");EntFire("scene4_watermelon_land_train","StartForward","",5);EntFire("bgm_timer_4","Enable","");EntFire("bgm_timer_4","FireTimer","",0.01);EndRain();return;};if(h == 18)if(!sea_witch_flag){sea_witch_flag = 1;sea_witch_flag_2 = 1;};;local t = "HP: ";for (local i = 0; i < h; i++) {t += "█";}EntFire("boss_hp_bar","SetText",t,0.1);EntFire("boss_hp_bar","Display","",0.11);}function SeaWitchSkill(){EntFire("boss_env_sound","StopSound","");if(sea_witch_flag_2) {sea_witch_flag_2 = 0;SeaWitchChangePos();return;};local num = RandomInt(1,1000);switch (num%4){case 0:local o = Entities.FindByName(null,"scene4_sea_witch_box");if(o != null ) o.SetAbsOrigin(ModifyOriginZ(o.GetOrigin(),92));EntFire("scene4_sea_witch_splash","Stop","");EntFire("scene4_sea_witch_skill_timer","Disable","");EntFire("scene4_sea_witch","SetDefaultAnimation","");EntFire("scene4_sea_witch","SetAnimation","attack2_1");EntFire("scene4_sea_witch_ball","Start","",0.8);EntFire("boss_env_sound","AddOutput","message ze_atos/env/sea_witch_ball.mp3");EntFire("boss_env_sound","PlaySound","",0.8);EntFire("scene4_sea_witch_ball_trigger","Enable","",3.8);break;case 1:EntFire("boss_env_sound","AddOutput","message ze_atos/env/sea_witch_wave.mp3");EntFire("scene4_sea_witch","SetAnimation","attack1");local idx = ChooseNumbers(8,7);for(local i=0;i<7;i++){EntFire("scene4_sea_witch_wave_tp","AddOutput","origin "+sea_witch_ball_wave[idx[i]+8*sea_witch_pos],i*0.02);EntFire("scene4_sea_witch_wave_tp","ForceSpawn","",i*0.02+0.01);}EntFire("scene4_sea_witch_wave_particle*","Start","",0.5);EntFire("scene4_sea_witch_wave*","Open","",3.5);EntFire("boss_env_sound","PlaySound","",3.5);break;case 2:SeaWitchChangePos();break;case 3:EntFire("scene4_sea_witch_box","Disable","");EntFire("scene4_sea_witch_skill_timer","Disable","");EntFire("scene4_sea_witch_splash","Stop","");EntFire("scene4_sea_witch","SetAnimation","round");EntFire("scene4_sea_witch_around","Start","",1.5);EntFire("scene4_sea_witch_box","Enable","",8.8);EntFire("scene4_sea_witch_splash","Start","",8.8);EntFire("scene4_sea_witch_around","Stop","",26.5);for(local i=0;i<5;i++){EntFire("scene4_sea_witch_round_trigger","Enable","",2.5+5*i);}EntFire("scene4_sea_witch_skill_timer","Enable","",20);break;}}function SeaWitchBall() {sea_witch_ball_count += 1;local h = Entities.FindByName(null,"scene4_sea_witch_ball");if(sea_witch_ball_count < 6 && h != null){local p = activator;local distance = GetDistance(p.GetOrigin(),h.GetOrigin());distance = distance.tointeger();EntFire("scene4_sea_witch_ball_train","SetMaxSpeed",distance.tostring());EntFire("scene4_sea_witch_ball_track_1","AddOutput","origin "+ConvertOrigin(h.GetOrigin()));EntFire("scene4_sea_witch_ball_track_2","AddOutput","origin "+ConvertOrigin(p.GetOrigin()));EntFire("scene4_sea_witch_ball_damage_tp","AddOutput","origin "+ConvertOrigin(p.GetOrigin()));EntFire("scene4_sea_witch_ball_damage_tp","ForceSpawn","",0.01);EntFire("scene4_sea_witch_ball_beam","TurnOn","",0.1);EntFire("scene4_sea_witch_ball_train","TeleportToPathNode","scene4_sea_witch_ball_track_1",1);EntFire("scene4_sea_witch_ball_train","StartForward","",1.1);EntFire("scene4_sea_witch_ball_move","Start","",1.1);}else {local o = Entities.FindByName(null,"scene4_sea_witch_box");if(o != null ) o.SetAbsOrigin(ModifyOriginZ(o.GetOrigin(),-92));EntFire("scene4_sea_witch_splash","Start","",0.5);sea_witch_ball_count = 0;EntFire("scene4_sea_witch","SetDefaultAnimation","idle");EntFire("scene4_sea_witch","SetAnimation","attack2_2");EntFire("scene4_sea_witch_ball","Stop","");EntFire("scene4_sea_witch_skill_timer","Enable","");}}function SeaWitchChangePos() {if(sea_witch_flag){EntFire("scene4_sea_witch_splash","Stop","");EntFire("scene4_sea_witch_skill_timer","Disable","");EntFire("scene4_sea_witch_skill_timer","Enable","",1);local origin = "9763 -11109 9257";EntFire("scene4_sea_witch","SetDefaultAnimation","");EntFire("scene4_sea_witch","SetAnimation","down");EntFire("scene4_sea_witch_box","Disable","");sea_witch_pos = RandomInt(1,1000)%4;switch (sea_witch_pos) {case 1:origin = "8547 -12309 9257";break;case 2:origin = "9763 -13525 9257";break;case 3:origin = "10979 -12309 9257";break;}EntFire("scene4_sea_witch_parent","AddOutput","origin "+origin,3);EntFire("scene4_sea_witch_parent","AddOutput","angles 0 "+(sea_witch_pos*90)+" 0",3);EntFire("scene4_sea_witch_wave_tp","AddOutput","angles 0 "+(sea_witch_pos*90)+" 0",3);EntFire("scene4_sea_witch","SetDefaultAnimation","idle",4);EntFire("scene4_sea_witch","SetAnimation","up",4);EntFire("scene4_sea_witch_start_particle","Start","",4.2);EntFire("scene4_sea_witch_start_particle","Stop","",8);EntFire("scene4_sea_witch_splash","Start","",4.5);EntFire("scene4_sea_witch_box","Enable","",5);}else SeaWitchSkill();}function SeaWitchAround(){if(sea_witch_die != 1){EntFire("boss_env_sound","StopSound","");EntFire("boss_env_sound","AddOutput","message ze_atos/env/sea_witch_round.mp3");EntFire("boss_env_sound","PlaySound","",2);local p = activator;EntFire("scene4_sea_witch_around_tp","AddOutput","origin "+ConvertOrigin(p.GetOrigin()));EntFire("scene4_sea_witch_around_tp","ForceSpawn","",0.01);if(GetDistance(p.GetOrigin(),Vector(9769,-12322,9249)) >= 200){local n = (19538-p.GetOrigin().x)+" "+(-24644-p.GetOrigin().y)+" "+p.GetOrigin().z;EntFire("scene4_sea_witch_around_tp","AddOutput","origin "+n,0.02);EntFire("scene4_sea_witch_around_tp","ForceSpawn","",0.03);};EntFire("scene4_sea_witch_around_particle*","Start","",1);EntFire("scene4_sea_witch_around_hurt*","Enable","",4);EntFire("scene4_sea_witch_around_hurt*","Kill","",4.3);EntFire("scene4_sea_witch_around_particle*","Kill","",4.9);}}function GetDistance(v1,v2) {return sqrt(pow((v1.x-v2.x),2)+pow((v1.y-v2.y),2)+pow((v1.z-v2.z),2));}function SpawnFishLaser(){EntFire("cmd","Command","say <--Oh!Fish attacks-->");local a = g_fish_counts.slice(0);a.sort(function(a,b){return b-a;});if(a[0] > 0){for (local i = 0; i < g_fish_counts.len(); i++){if(a[0] == g_fish_counts[i])if(i != g_fish_counts.len()-1){EntFire("scene4_fishlaser_template","Kill","",i+1);EntFire("scene4_wavelaser_template","Kill","");break;}}};for (local i = 0; i < 9; i++){EntFire("scene4_fishlaser_template","ForceSpawn","",i+0.1);if(i==0 || i==8){EntFire("scene4_fishlaser_template","AddOutput","origin 10035 -14410 9137",i);EntFire("scene4_fishlaser_template","AddOutput","angles 0 0 0",i);};if(i==1 || i==7){EntFire("scene4_fishlaser_template","AddOutput","origin 10242 -13361 9137",i);EntFire("scene4_fishlaser_template","AddOutput","angles 0 -22.597 0",i);};if(i==2 || i==6){EntFire("scene4_fishlaser_template","AddOutput","origin 10831 -12479 9137",i);EntFire("scene4_fishlaser_template","AddOutput","angles 0 -45.209 0",i);};if(i==3 || i==5){EntFire("scene4_fishlaser_template","AddOutput","origin 11713 -11889 9137",i);EntFire("scene4_fishlaser_template","AddOutput","angles 0 -67.498 0",i);};if(i==4){EntFire("scene4_fishlaser_template","AddOutput","origin 14679 -12478 9137",i);EntFire("scene4_fishlaser_template","AddOutput","angles 0 -134.943 0",i);}}EntFire("scene4_wavelaser_template","ForceSpawn","",9);EntFire("scene4_plane","Open","",13);EntFire("scene4_plane","FireUser1","",13);}function SetFishLaser(){local n = RandomInt(0,2);if(n==1) EntFireByHandle(caller,"AddOutput","origin "+ConvertOrigin(ModifyOriginZ(caller.GetOrigin(),40)),0,null,null);if(n==2) EntFireByHandle(caller,"AddOutput","origin "+ConvertOrigin(ModifyOriginZ(caller.GetOrigin(),168)),0,null,null);n = RandomInt(0,4);local c = null;switch (n) {case 0:c = "255 0 0";break;case 1:c = "0 255 0";break;case 2:c = "0 0 255";break;case 3:c = "128 0 255";break;case 4:c = "0 0 0";break;}EntFireByHandle(caller,"AddOutput","rendercolor "+c,0,null,null);}function SpawnWaveLaser(){for(local i=1;i<7;i++){if(i == 6){EntFire("scene4_wavelaser_fish","SetAnimation","jump_slow_far",0.01);EntFire("scene4_wavelaser_move","AddOutput","renderamt 255",0.81);EntFire("scene4_wavelaser_hurt","Enable","",0.81);EntFire("scene4_wavelaser_train","StartForward","",0.81);EntFire("scene4_wavelaser_sound","PlaySound","",0.81);EntFire("scene4_wavelaser_splash","Start","",1.5);EntFire("scene4_wavelaser_splash","Kill","",2.5);EntFire("scene4_wavelaser_fish","Kill","",2.01);}else{local name = "scene4_wavelaser_path_" + i.tostring();local path = Entities.FindByName(null,name);if(path != null){local origin = path.GetOrigin();local num = RandomInt(0,100);if(num % 2 != 0){origin = Vector(origin.x,origin.y,origin.z+100);path.SetOrigin(origin);}}}}}function SpawnScene4Item(){local o = ["4649 -8827 9168", "6039 -12251 9240", "4963 -11893 9290"];local p = ["6269 -10293 9277", "6269 -9781 9277", "6269 -9269 9277", "5505 -9269 9277", "5505 -9781 9277", "5505 -10293 9277"];local num = RandomInt(0,2);EntFire("item_health_human_template","AddOutput","origin "+o[num]);EntFire("item_health_human_template","ForceSpawn","",0.01);local n = ChooseNumbers(p.len(),2);EntFire("item_magic_template","AddOutput","origin "+p[n[0]]);EntFire("item_magic_template","ForceSpawn","",0.01);EntFire("item_scorched_earth_template","AddOutput","origin "+p[n[1]]);EntFire("item_scorched_earth_template","ForceSpawn","",0.01);}function ShowFishVote(){local a = g_fish_counts.slice(0);local cmd = null;a.sort(function(a,b){return b-a;});for (local i = 0; i < g_fish_counts.len(); i++){if(a[0] == g_fish_counts[i]){cmd = "say <--Voting results: "+(i+1)+" lasers-->";break;}}if(a[0]  == 0){cmd = "say <--Voting results: 5 lasers-->";g_fish_counts[4]++;};EntFire("cmd","Command",cmd);}